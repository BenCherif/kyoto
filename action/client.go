package action

var client = `"use strict";(()=>{function L(e){let a=null;if(e.id&&(a=document.getElementById(e.id)),!a){let t=e.start,r=0;for(;t.parentElement;){if(!t.getAttribute("component")){t=t.parentElement;continue}if(e.depth===r){a=t;break}t=t.parentElement,r++}}if(!a)throw new Error(` + "`" + `Root element not found with parameters ${e}.` + "`" + `);return a}var Y=11;function se(e,a){var t=a.attributes,r,n,l,s,p;if(!(a.nodeType===Y||e.nodeType===Y)){for(var u=t.length-1;u>=0;u--)r=t[u],n=r.name,l=r.namespaceURI,s=r.value,l?(n=r.localName||n,p=e.getAttributeNS(l,n),p!==s&&(r.prefix==="xmlns"&&(n=r.name),e.setAttributeNS(l,n,s))):(p=e.getAttribute(n),p!==s&&e.setAttribute(n,s));for(var g=e.attributes,m=g.length-1;m>=0;m--)r=g[m],n=r.name,l=r.namespaceURI,l?(n=r.localName||n,a.hasAttributeNS(l,n)||e.removeAttributeNS(l,n)):a.hasAttribute(n)||e.removeAttribute(n)}}var P,ue="http://www.w3.org/1999/xhtml",v=typeof document>"u"?void 0:document,fe=!!v&&"content"in v.createElement("template"),ce=!!v&&v.createRange&&"createContextualFragment"in v.createRange();function pe(e){var a=v.createElement("template");return a.innerHTML=e,a.content.childNodes[0]}function he(e){P||(P=v.createRange(),P.selectNode(v.body));var a=P.createContextualFragment(e);return a.childNodes[0]}function ve(e){var a=v.createElement("body");return a.innerHTML=e,a.childNodes[0]}function me(e){return e=e.trim(),fe?pe(e):ce?he(e):ve(e)}function _(e,a){var t=e.nodeName,r=a.nodeName,n,l;return t===r?!0:(n=t.charCodeAt(0),l=r.charCodeAt(0),n<=90&&l>=97?t===r.toUpperCase():l<=90&&n>=97?r===t.toUpperCase():!1)}function ge(e,a){return!a||a===ue?v.createElement(e):v.createElementNS(a,e)}function be(e,a){for(var t=e.firstChild;t;){var r=t.nextSibling;a.appendChild(t),t=r}return a}function K(e,a,t){e[t]!==a[t]&&(e[t]=a[t],e[t]?e.setAttribute(t,""):e.removeAttribute(t))}var Q={OPTION:function(e,a){var t=e.parentNode;if(t){var r=t.nodeName.toUpperCase();r==="OPTGROUP"&&(t=t.parentNode,r=t&&t.nodeName.toUpperCase()),r==="SELECT"&&!t.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!a.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),t.selectedIndex=-1)}K(e,a,"selected")},INPUT:function(e,a){K(e,a,"checked"),K(e,a,"disabled"),e.value!==a.value&&(e.value=a.value),a.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,a){var t=a.value;e.value!==t&&(e.value=t);var r=e.firstChild;if(r){var n=r.nodeValue;if(n==t||!t&&n==e.placeholder)return;r.nodeValue=t}},SELECT:function(e,a){if(!a.hasAttribute("multiple")){for(var t=-1,r=0,n=e.firstChild,l,s;n;)if(s=n.nodeName&&n.nodeName.toUpperCase(),s==="OPTGROUP")l=n,n=l.firstChild;else{if(s==="OPTION"){if(n.hasAttribute("selected")){t=r;break}r++}n=n.nextSibling,!n&&l&&(n=l.nextSibling,l=null)}e.selectedIndex=t}}},O=1,Z=11,ee=3,te=8;function N(){}function Ae(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function Te(e){return function(t,r,n){if(n||(n={}),typeof r=="string")if(t.nodeName==="#document"||t.nodeName==="HTML"||t.nodeName==="BODY"){var l=r;r=v.createElement("html"),r.innerHTML=l}else r=me(r);else r.nodeType===Z&&(r=r.firstElementChild);var s=n.getNodeKey||Ae,p=n.onBeforeNodeAdded||N,u=n.onNodeAdded||N,g=n.onBeforeElUpdated||N,m=n.onElUpdated||N,V=n.onBeforeNodeDiscarded||N,b=n.onNodeDiscarded||N,x=n.onBeforeElChildrenUpdated||N,ie=n.skipFromChildren||N,X=n.addChild||function(o,i){return o.appendChild(i)},I=n.childrenOnly===!0,w=Object.create(null),H=[];function U(o){H.push(o)}function z(o,i){if(o.nodeType===O)for(var c=o.firstChild;c;){var d=void 0;i&&(d=s(c))?U(d):(b(c),c.firstChild&&z(c,i)),c=c.nextSibling}}function E(o,i,c){V(o)!==!1&&(i&&i.removeChild(o),b(o),z(o,c))}function J(o){if(o.nodeType===O||o.nodeType===Z)for(var i=o.firstChild;i;){var c=s(i);c&&(w[c]=i),J(i),i=i.nextSibling}}J(t);function F(o){u(o);for(var i=o.firstChild;i;){var c=i.nextSibling,d=s(i);if(d){var f=w[d];f&&_(i,f)?(i.parentNode.replaceChild(f,i),D(f,i)):F(i)}else F(i);i=c}}function oe(o,i,c){for(;i;){var d=i.nextSibling;(c=s(i))?U(c):E(i,o,!0),i=d}}function D(o,i,c){var d=s(i);d&&delete w[d],!(!c&&(g(o,i)===!1||(e(o,i),m(o),x(o,i)===!1)))&&(o.nodeName!=="TEXTAREA"?le(o,i):Q.TEXTAREA(o,i))}function le(o,i){var c=ie(o),d=i.firstChild,f=o.firstChild,M,A,S,R,T;e:for(;d;){for(R=d.nextSibling,M=s(d);!c&&f;){if(S=f.nextSibling,d.isSameNode&&d.isSameNode(f)){d=R,f=S;continue e}A=s(f);var B=f.nodeType,y=void 0;if(B===d.nodeType&&(B===O?(M?M!==A&&((T=w[M])?S===T?y=!1:(o.insertBefore(T,f),A?U(A):E(f,o,!0),f=T):y=!1):A&&(y=!1),y=y!==!1&&_(f,d),y&&D(f,d)):(B===ee||B==te)&&(y=!0,f.nodeValue!==d.nodeValue&&(f.nodeValue=d.nodeValue))),y){d=R,f=S;continue e}A?U(A):E(f,o,!0),f=S}if(M&&(T=w[M])&&_(T,d))c||X(o,T),D(T,d);else{var G=p(d);G!==!1&&(G&&(d=G),d.actualize&&(d=d.actualize(o.ownerDocument||v)),X(o,d),F(d))}d=R,f=S}oe(o,f,A);var j=Q[o.nodeName];j&&j(o,i)}var h=t,C=h.nodeType,q=r.nodeType;if(!I){if(C===O)q===O?_(t,r)||(b(t),h=be(t,ge(r.nodeName,r.namespaceURI))):h=r;else if(C===ee||C===te){if(q===C)return h.nodeValue!==r.nodeValue&&(h.nodeValue=r.nodeValue),h;h=r}}if(h===r)b(t);else{if(r.isSameNode&&r.isSameNode(h))return;if(D(h,r,I),H)for(var W=0,de=H.length;W<de;W++){var $=w[H[W]];$&&E($,$.parentNode,!1)}}return!I&&h!==t&&t.parentNode&&(h.actualize&&(h=h.actualize(t.ownerDocument||v)),t.parentNode.replaceChild(h,t)),h}}var ye=Te(se),re=ye;function k(e,a,t){let r=new Array,n={};t&&(n=t),n.onBeforeElUpdated=function(l,s){if(l.getAttribute("action:morph.ignore.attr")!=null){let p=l.getAttribute("ssa:morph.ignore.attr");if(p)if(p=="innerHTML")s.innerHTML=l.innerHTML;else{let u=l.getAttribute(p);u&&s.setAttribute(p,u)}}return l.getAttribute("action:morph.ignore")!=null?!1:l.getAttribute("action:morph.ignore.this")!=null&&l!=e?(r.push({fromEl:l,toEl:s}),!1):!0},re(e,a,n),r.length>0&&r.forEach(l=>{k(l.fromEl,l.toEl,{childrenOnly:!0})})}async function ne(e,a,...t){let r=Ne(a),n=L({start:e,depth:r.depth,id:r.id});we(n);let l=actionpath.endsWith("/")?actionpath:actionpath+"/";l+=` + "`" + `${n.getAttribute("name")}` + "`" + `,l+=` + "`" + `/${r.name}` + "`" + `;let s=new FormData;s.set("State",n.getAttribute("state")),s.set("Args",JSON.stringify(t));let p=new XMLHttpRequest;p.open("POST",l,!0);let u="",g=0;p.onprogress=()=>{let m=p.responseText.length;if(g==m)return;let V=p.responseText.substring(g,m);if(u+=V,console.log(u,u.endsWith(actionterminator)),u.endsWith(actionterminator)){if(u=u.slice(0,-actionterminator.length),u.startsWith("action\\:redirect")){window.location.href=u.replace(` + "`" + `${"action\\:redirect"}=` + "`" + `,"");return}let b=n.getAttribute("action\\:render")||"morph";switch(n.getAttribute("action\\:render.replace")!==null&&(b="replace"),n.getAttribute("action\\:render.morph")!==null&&(b="morph"),b){case"replace":n.outerHTML=u;break;case"morph":try{k(n,u)}catch(x){console.warn('fallback from "morph" to "replace" due to an error:',x),n.outerHTML=u}break;default:console.warn('render mode is not supported, fallback to "morph"');try{k(n,u)}catch(x){console.warn('fallback from "morph" to "replace" due to an error:',x),n.outerHTML=u}break}u=""}g=m},p.send(s)}function Ne(e){let a=e.split("."),t=a[a.length-1],r=0,n;return e.startsWith("#")&&(n=a[1]),e.startsWith("$")&&(r=parseInt(a[1])),{name:t,depth:r,id:n}}function we(e){e.querySelectorAll(` + "`" + `[${"action\\:display"}]` + "`" + `).forEach(t=>{let r=t.getAttribute("action\\:display");r&&(t.style.display=r)})}async function ae(e,a){let t=L({start:e});if(!t.getAttribute("state"))throw new Error("bind call error, component state is undefined");let r;try{r=JSON.parse(decodeURIComponent(atob(t.getAttribute("state"))))}catch{throw new Error("bind call error, can't decode state (probably it's not universal')")}r[a]=e.value,t.setAttribute("state",btoa(encodeURIComponent(JSON.stringify(r))))}window.action=ne;window.bind=ae;window.root=L;})();
`
